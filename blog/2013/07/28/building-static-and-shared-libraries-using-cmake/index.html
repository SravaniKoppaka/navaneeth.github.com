
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Building static and shared libraries using CMake - {love to code}</title>
	<meta name="author" content="nkn">

	
	<meta name="description" content="Building Static and Shared Libraries Using CMake Jul 28th, 2013 Recently in libvarnam, I had to build a static and shared library from the same &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="{love to code}" type="application/atom+xml">
	
	<link rel="canonical" href="http://navaneeth.github.io/blog/2013/07/28/building-static-and-shared-libraries-using-cmake/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	Included file 'custom/head.html' not found in _includes directory
</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul></nav>
<!-- <nav id="sub-nav">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/navaneethkn" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/navaneeth" title="GitHub">GitHub</a>
		
		
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav> -->
<div class="profile-container">
  <div class="profilepic">
    <script src="/javascripts/md5.js"></script>
    <script type="text/javascript">
$(function(){
  $('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5("navaneethkn@gmail.com") + "?s=160' alt='Profile Picture' style='width: 160px;' />");
});
    </script>
  </div>
  <hgroup>
  <h1 class="site-title"><a href="/">{love to code}</a></h1>
  
  <p class="site-subtitle">Random thoughts on programming and travel.</p>
  
  </hgroup>
  
</div>
</header>
			</div>
		</div>
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="article-inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  
	<h1 class="title" itemprop="name">Building Static and Shared Libraries Using CMake</h1>
  








  



  <div class="post-date"><time datetime="2013-07-28T19:46:00+05:30" data-updated="true" itemprop="datePublished">Jul 28<span>th</span>, 2013</time></div>
	<div class="entry-content" itemprop="articleBody"><p>Recently in <a href="https://github.com/navaneeth/libvarnam">libvarnam</a>, I had to build a static and shared library from the same source files. This was much harder before CMake 2.8. From CMake 2.8.8, CMake has support for <code>Object library</code> which made it very simple.</p>

<p>Basic idea is to use <code>add_library</code> with <code>OBJECT</code> type. CMake will compile all the source files provided in this target and makes the object files for it. It won&rsquo;t create a temporary static library with all these object files. These object files can later be referred in the target which builds the library. In my CMakeLists.txt, I have the following.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">add_library</span> <span class="p">(</span><span class="n">core</span> <span class="n">OBJECT</span> <span class="err">$</span><span class="p">{</span><span class="n">SOURCES</span><span class="p">})</span>
</span><span class='line'><span class="n">add_library</span> <span class="p">(</span><span class="k">static</span> <span class="n">STATIC</span> <span class="err">$</span><span class="o">&lt;</span><span class="n">TARGET_OBJECTS</span><span class="o">:</span><span class="n">core</span><span class="o">&gt;</span><span class="p">)</span>
</span><span class='line'><span class="n">add_library</span> <span class="p">(</span><span class="n">shared</span> <span class="n">SHARED</span> <span class="err">$</span><span class="o">&lt;</span><span class="n">TARGET_OBJECTS</span><span class="o">:</span><span class="n">core</span><span class="o">&gt;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>The above will build static and shared library from the same set of object files. This improves compilation time considerably as source files will be compiled only once and used in multiple targets.</p>
</div>
	<div class="meta"><span class="tags">


	<a class='category' href='/blog/categories/build/'>build,</a>, <a class='category' href='/blog/categories/cmake/'>cmake</a>


</span></div>

</article>

	<div class="share">
	<div class="share_icon_group addthis_toolbox addthis_default_style addthis_32x32_style">
	
  <a class="share_icon addthis_button_preferred_1"></a>
	
	
	
	<a class="share_icon addthis_button_preferred_4"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright &copy; 2014 - nkn -
  <span class="credit"><a href="http://octopress.org">Octopress</a></span>
</p>


<p>Theme: <a href="https://github.com/qingwang/octopress-theme-yinyang">YinYang</a></p>
</footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'lovetocode';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://navaneeth.github.io/blog/2013/07/28/building-static-and-shared-libraries-using-cmake/';
        var disqus_url = 'http://navaneeth.github.io/blog/2013/07/28/building-static-and-shared-libraries-using-cmake/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-38544003-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



		</div>
	</div>
</body>
</html>
